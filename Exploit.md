# CVE-2022-

Submission by Team 13

# Description

dedecmdv6 v6.1.9 is vulnerable to Remote Code Execution (RCE) via
file_manage_control.php.

https://nvd.nist.gov/vuln/detail/CVE-2022-

# Exploit

## Analyzing file_manage_control.php

Version 6.1.9 of the package has the __upload() function in file_manage_control.php
which is used to upload files to the file management system.

## Analyzing __upload()

The part of the code labelled __upload() performs a MIME-type check on our uploaded
file using the function get_mime_type:

```
/*---------------
function __upload();
----------------*/
else if ($fmdo == "upload") {
$j = 0 ;
for ($i = 1 ; $i <= 50 ; $i++) {
$upfile = "upfile".$i;
$upfile_name = "upfile".$i."_name";
if (! isset (${$upfile}) ||! isset (${$upfile_name})) {
continue ;
}
$upfile = ${$upfile};
$upfile_name = ${$upfile_name};
if (is_uploaded_file($upfile)) {
// 
